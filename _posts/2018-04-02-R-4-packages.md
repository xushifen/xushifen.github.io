---
layout: post
title:  "R包的管理"
date:   2018-04-02 19:06:05
categories: Program
tags: R
---

## handle R packages by command lines in windows



### **R包的安装是使用R的基本技能，下面介绍几种在windows环境下安装R包的方法**

#### 1. 基本安装，直接从R的[CRAN](https://mirrors.tuna.tsinghua.edu.cn/CRAN/)下载

```R
install.packages("ggpplot2", dependencies=T, repos="https://mirrors.tuna.tsinghua.edu.cn/CRAN")
```

* dependencies : 该参数可以安装除ggplot2以外的依赖包
* repos : 指定ggplot2的包源的CRAN地址（*清华大学*的CRAN在国内是最好的）



#### 2. github安装，因为有些第三方包是github开发者开发且没有提交到CRAN上 

**2.1** 安装githubinstall包，该包可以通过第一步的基本安装实现
```R
install.packages("githubinstall")   ## 已经发布到CRAN
```
**2.2** 安装AnomalyDetection包

```R
library(githubinstall)
githubinstall("AnomalyDetection", ref="master")
```
**2.3** 使用devtools包安装
```R
install.packages("devtools")
library(devtools)
install_github("lch14forever/microbiomeViz")
```



#### 3. 基于[bioconductor](https://www.bioconductor.org/)安装

```R
source("http://bioconductor.org/biocLite.R")
options(BioC_mirror="http://mirrors.ustc.edu.cn/bioc/") # 选用中科大的bioconductor镜像
library(BiocInstaller)
biocLite("DirichletMultinomial")
```

- source函数会读取biocLite.R脚本，该脚本拥有很多函数，比如biocLite安装包函数
- [网址错误](https://support.bioconductor.org/p/74540/)； https和http的区别



#### 4. 本地安装.zip压缩等文件

```R
install.packages("E:/ggplot2/ggplot2*.zip")   ## 引号为绝对路径
```





### R包管理和查看

#### 1. **加载包的两种方式，library和require**

```R
> library(ggplot2)
> require(ggplot2)

## test 
> test <- library("abc")
Error in library("abc") : there is no package called 'abc'
> test
Error: object 'test' not found
> test <- require("abc")
Loading required package: abc
Warning message:
In library(package, lib.loc = lib.loc, character.only = TRUE, logical.return = TRUE,  :
  there is no package called 'abc'
> test
[1] FALSE
```

- **区别**：当不存在R包时候，library直接输出报错信息并且终止程序运行，而require输出是警告且继续运行加载包后的程序。[详细信息](https://stackoverflow.com/questions/5595512/what-is-the-difference-between-require-and-library)



#### 2. **查看R包**

```R
1. getOption("defaultPackages")    ## 查看默认加载的包
2. installed.packages()       ## 查看所有已经安装的R包，包含版本信息等
3. .packages(all.available = T) ## 查看所有已经安装的R包，只有包的名字
```



#### 3. 更新和卸载包

**3.1** [更新包](https://www.rdocumentation.org/packages/utils/versions/3.4.3/topics/update.packages)

```R
>old.packages()
      Package LibPath                              Installed Built   ReposVer
RUnit "RUnit" "E:/software/anaconda/Lib/R/library" "0.4.26"  "3.3.1" "0.4.31"
      Repository                                                  
RUnit "https://mran.microsoft.com/snapshot/2017-09-01/src/contrib"

>update.packages()
RUnit :
 Version 0.4.26 installed in E:/software/anaconda/Lib/R/library 
 Version 0.4.31 available at https://mran.microsoft.com/snapshot/2017-09-01

>new.packages()
   [1] "A3"                          "abbyyR"                      "abc"                         "abc.data"                   
   [5] "ABC.RAP"                     "ABCanalysis"                 "abcdeFBA"                    #"ABCoptim"
```

- old.packages表示软件包在CRAN上具有（合适的）更高版本，而update.packages提供下载和安装此类软件包。
- new.packages将在尚未安装的存储库上查找（合适的）软件包，并可选择提供它们进行安装。



**3.2** 卸载包

```R
1. remove.packages(pkgs, lib)  ## 移除包
2. detach("package:pkgs")      ## 把包移除当前运行环境
```
- lib: 指明卸载包安装目录. 如果缺失，则默认是 `.libPaths()`目录。



#### 4. 升级R，但不重装packages

**拷贝R旧版本的library目录文件夹至新版本library目录下，再使用如下命令更新**

```R
update.packages(checkBuilt = T, ask = F)
# or install.packages(.packages(all = T))
```



##### Reference

1. [153分钟学会R](https://cran.r-project.org/doc/contrib/Liu-FAQ.pdf)

参考文章如引起任何侵权问题，可以与我[联系](https://github.com/HuaZou/)，谢谢。
