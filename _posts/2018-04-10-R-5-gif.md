---
layout: post
title:  "R动态图"
date:   2018-04-10 13:10:00
categories: Program
tags: R
---

打开**[R语言中文社区](https://zhuanlan.zhihu.com/p/29911203)**公众号，发现R怎么制作gif等

### 准备包

* ImageMagick ：产生动画

```R
install.packages("installr")
installr::install.ImageMagick("http://www.imagemagick.org/script/download.php")
```

* gganimate：制作动画，可以映射

```R
install.packages("devtools")
devtools::install_github("dgrtwo/gganimate")
```

* [animation](https://cran.r-project.org/web/packages/animation/animation.pdf) : 保存gif等

```R
install.packages("animation")
```

### 运行

```R
library(gapminder)
library(gganimate)
library(animation)
library(ggplot2)

p <- ggplot(gapminder, aes(gdpPercap, lifeExp, size=pop, 		      color=continent,frame=year))+
     geom_point()+
     scale_x_log10()
magickPath <- shortPathName("C:\\Program Files\\ImageMagick-7.0.7-Q16\\magick.exe")    # 设置路径
ani.options(convert=magickPath)  # 设置convert参数

gganimate(p, "out.gif") # 生成且保留gif
```

![](https://raw.githubusercontent.com/HuaZou/HuaZou.github.io/master/_posts/img/R.dynamic.gif)


### 总结

**1**. c:\program 路径无法找到：环境变量设置

```R
Sys.setenv(PATH = paste("C:/Program Files/ImageMagick-7.0.7-Q16/bin",
 Sys.getenv("PATH"), sep = ";"))
```

**2**. ImageMagick旧版本的convert不可用（将png转成gif的工具），使用谢大神的新版本animation

```R
devtools::install_github("yihui/animation").
```


#### Reference

1. [博客](https://ytlogos.github.io/2018/02/06/R%E8%AF%AD%E8%A8%80%E5%8F%AF%E8%A7%86%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bgganimate%E5%8C%85/)

2. [缺失convert.exe](https://github.com/dgrtwo/gganimate/issues/45)

3. [新版本convert](https://github.com/dgrtwo/gganimate/issues/22)

4. [c:\program路径找不到](https://stackoverflow.com/questions/41129257/gganimate-unable-to-call-imagemagick-correctly-possible-path-error)

参考文章如引起任何侵权问题，可以与我[联系](https://github.com/HuaZou/)，谢谢。
